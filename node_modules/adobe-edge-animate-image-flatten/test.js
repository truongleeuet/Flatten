var flatten 	= require('./index'),
	path 		= require('path'),
	fs 			= require('fs');
//console.log(path.resolve(__dirname, 'publish/web/HTC-1600_1200_edge.js'));
//read file
fs.createReadStream(path.resolve(__dirname, 'publish/web/vespa_edge.js'))

//flatten task
.pipe(flatten({imageDirectory: path.resolve(__dirname, 'publish/web/images')}))

.on('data', function (data) {

	console.log("Tests:");

	//console.log('Image directory should be the base64 image string: ' + (data.indexOf("var im='data:image/png;base64,'") !== -1 ? "pass" : "fail"));

	///console.log('There should be no .svg strings: ' + (data.indexOf(".svg") === -1 ? "pass" : "fail"));
	//console.log(data);
	//fs.writeFile();
		fs.writeFileSync("result.js", data);
		console.log("Finish");
})

.on('end', function () {

	console.log("Done");

});
